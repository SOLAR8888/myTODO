(this["webpackJsonpsolar-todo-client"]=this["webpackJsonpsolar-todo-client"]||[]).push([[0],{44:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(37),s=n.n(c),o=(n(44),n(23));function i(){}var u,l,b=Object(a.createContext)({token:null,userId:null,login:i,logout:i,isAuthenticated:!1}),d=Object(a.createContext)(),j=n(1),O=function(){var e=Object(a.useContext)(d),t=Object(a.useContext)(b);return Object(j.jsxs)("nav",{className:"navbar navbar-dark navbar-expand-lg bg-dark",children:[Object(j.jsx)("div",{className:"navbar-brand",children:"TODOwe4ka"}),t.isAuthenticated&&Object(j.jsx)("button",{onClick:function(){t.logout(),e.hide()},type:"button",className:"btn btn-outline-light m-1",children:"\u0412\u044b\u0439\u0442\u0438"})]})},p=function(){var e=Object(a.useContext)(d),t=e.alert,n=e.hide;return t.visible?Object(j.jsxs)("div",{className:"alert alert-".concat(t.type||"warning"," alert-dismissible"),children:[Object(j.jsx)("strong",{children:"success"===t.type?"\u0423\u0445 \u0442\u044b! ":"\u042d\u043c\u043c... "}),t.text,Object(j.jsx)("button",{onClick:n,type:"button",className:"btn-close","aria-label":"Close"})]}):null},f=n(6),h=n(8),m=n(3),x="SHOW_ALERT",v="HIDE_ALERT",g="SHOW_LOADER",N="ADD_NOTE",w="FETCH_NOTES",y="REMOVE_NOTE",k="UPDATE_NOTE",C=(u={DEFAULT:function(e){return e}},Object(h.a)(u,x,(function(e,t){var n=t.payload;return Object(m.a)(Object(m.a)({},n),{},{visible:!0})})),Object(h.a)(u,v,(function(e){return Object(m.a)(Object(m.a)({},e),{},{visible:!1})})),u),E=function(e,t){return(C[t.type]||C.DEFAULT)(e,t)},S=function(e){var t=e.children,n=Object(a.useReducer)(E,{visible:!1}),r=Object(f.a)(n,2),c=r[0],s=r[1],o=function(){return s({type:v})};return Object(j.jsx)(d.Provider,{value:{show:function(e){},hide:o,alert:c},children:t})},T=n(5),_=Object(a.createContext)(),A=function(){var e=Object(a.useState)(""),t=Object(f.a)(e,2),n=t[0],r=t[1],c=Object(a.useContext)(d),s=Object(a.useContext)(_).addNote,o=Object(a.useContext)(b).token;return Object(j.jsx)("form",{onSubmit:function(e){e.preventDefault(),n.trim()?(s(n,o),r("")):c.show("\u0417\u0430\u043c\u0435\u0442\u043a\u0430 \u043f\u0443\u0441\u0442\u0430\u044f")},className:"form-inline",children:Object(j.jsx)("div",{className:"form-group",children:Object(j.jsxs)("div",{className:"input-group",children:[Object(j.jsx)("input",{type:"text",className:"form-control",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u043c\u0435\u0442\u043a\u0438",value:n,onChange:function(e){r(e.target.value)}}),Object(j.jsx)("div",{className:"input-group-append",children:Object(j.jsx)("button",{type:"submit",className:"btn btn-outline-secondary",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})})})},D=n(4),F=n.n(D),I=n(10),P=n(24),L=n(14),B=n(25),R=function(e){var t=e.notes,n=e.filter;L.b.add(B.a,B.b);var r=Object(a.useContext)(_),c=r.removeNote,s=r.updateNote,o=Object(a.useContext)(b).token,i=Object(a.useState)(""),u=Object(f.a)(i,2),l=u[0],d=u[1],O=Object(a.useState)(!1),p=Object(f.a)(O,2),h=p[0],m=p[1],x=function(){var e=Object(I.a)(F.a.mark((function e(t,n,a){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),d(t),e.next=4,s(t,n,a);case 4:m(!1),d("");case 6:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),v=function(){var e=Object(I.a)(F.a.mark((function e(t,n){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),d(t),e.next=4,c(t,n);case 4:m(!1),d("");case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(j.jsx)("ul",{className:"list-group",children:t.filter((function(e){switch(n){case 0:return!0;case 1:return e.done;case 2:return!e.done}return!0})).map((function(e){return Object(j.jsxs)("li",{className:"list-group-item note",children:[Object(j.jsxs)("div",{className:"note-text",children:[Object(j.jsxs)("strong",{style:e.done?{textDecoration:"line-through"}:{},children:[" ",e.text," "]}),Object(j.jsx)("div",{className:"text-info text-sm-start",children:new Date(e.createdAt).toLocaleString()})]}),Object(j.jsxs)("div",{className:"buttons",children:[Object(j.jsxs)("button",{onClick:function(){return x(e._id,!e.done,o)},className:e.done?"btn btn-success btn-sm mx-1":"btn btn-outline-success btn-sm mx-1",children:[(!h||l!==e._id)&&Object(j.jsx)(P.a,{className:"fa-fw",icon:"check"}),h&&l===e._id&&Object(j.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})]}),Object(j.jsxs)("button",{onClick:function(){return v(e._id,o)},"data-bs-toggle":"modal","data-bs-target":"#modal",type:"button",className:"btn btn-outline-danger btn-sm mx-1",children:[(!h||l!==e._id)&&Object(j.jsx)(P.a,{className:"fa-fw",icon:"times"}),h&&l===e._id&&Object(j.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})]})]})]},e.id)}))})},H=function(e){var t=e.filter,n=e.setFilter;return Object(j.jsx)("div",{className:"filter",children:Object(j.jsxs)("div",{className:"btn-group",role:"group","aria-label":"Basic example",children:[Object(j.jsx)("button",{onClick:function(){return n(0)},type:"button",className:"btn btn".concat(0===t?"":"-outline","-secondary"),children:"\u0412\u0441\u0435"}),Object(j.jsx)("button",{onClick:function(){return n(1)},type:"button",className:"btn btn".concat(1===t?"":"-outline","-secondary"),children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"}),Object(j.jsx)("button",{onClick:function(){return n(2)},type:"button",className:"btn btn".concat(2===t?"":"-outline","-secondary"),children:"\u041d\u0435\u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"})]})})},U=function(){var e=Object(a.useContext)(_),t=(e.loading,e.notes),n=e.fetchNotes,r=Object(a.useContext)(b).token,c=Object(a.useState)(0),s=Object(f.a)(c,2),o=s[0],i=s[1];return Object(a.useEffect)((function(){n(r)}),[]),Object(j.jsxs)(a.Fragment,{children:[Object(j.jsx)(A,{}),Object(j.jsx)("hr",{}),Object(j.jsx)(H,{filter:o,setFilter:i}),Object(j.jsx)(R,{notes:t,filter:o})]})},J=function(){var e=Object(a.useContext)(b),t=Object(a.useCallback)((function(e){window.M&&e&&window.M.toast({html:e})}),[]),n=function(){var e=Object(a.useState)(!1),t=Object(f.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),s=Object(f.a)(c,2),o=s[0],i=s[1];return{loading:n,request:Object(a.useCallback)(function(){var e=Object(I.a)(F.a.mark((function e(t){var n,a,c,s,o,u=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:"GET",a=u.length>2&&void 0!==u[2]?u[2]:null,c=u.length>3&&void 0!==u[3]?u[3]:{},r(!0),e.prev=4,a&&(a=JSON.stringify(a),c["Content-Type"]="application/json"),e.next=8,fetch(t,{method:n,body:a,headers:c});case 8:return s=e.sent,e.next=11,s.json();case 11:if(o=e.sent,s.ok){e.next=14;break}throw new Error(o.message||"\u041e\u0448\u0438\u0431\u043e\u0447\u043a\u0430 \u0432\u044b\u0448\u043b\u0430");case 14:return r(!1),e.abrupt("return",o);case 18:throw e.prev=18,e.t0=e.catch(4),r(!1),i(e.t0.message),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:o,clearError:Object(a.useCallback)((function(){return i(null)}),[])}}(),r=n.loading,c=n.error,s=n.request,o=n.clearError,i=Object(a.useState)({email:"",password:""}),u=Object(f.a)(i,2),l=u[0],d=u[1],O=Object(a.useState)(!0),p=Object(f.a)(O,2),x=p[0],v=p[1];Object(a.useEffect)((function(){t(c),o()}),[c,t,o]);var g=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];v(!x),e||(document.getElementById("email").value="",document.getElementById("password").value="")},N=function(e){d(Object(m.a)(Object(m.a)({},l),{},Object(h.a)({},e.target.name,e.target.value)))},w=function(){var n=Object(I.a)(F.a.mark((function n(){var a;return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,l.password===l.confirm){n.next=4;break}return t("\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"),n.abrupt("return");case 4:return n.next=6,s("/api/auth/register","POST",Object(m.a)({},l));case 6:(a=n.sent).token&&e.login(a.token,a.userId),t(a.message),n.next=13;break;case 11:n.prev=11,n.t0=n.catch(0);case 13:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(){return n.apply(this,arguments)}}(),y=function(){var t=Object(I.a)(F.a.mark((function t(){var n;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s("/api/auth/login","POST",Object(m.a)({},l));case 3:n=t.sent,e.login(n.token,n.userId),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return Object(j.jsx)(a.Fragment,{children:Object(j.jsxs)("div",{className:"card",children:[Object(j.jsx)("h5",{className:"card-header",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"}),Object(j.jsxs)("div",{className:"card-body",children:[Object(j.jsxs)("div",{className:"form-floating mb-3",children:[Object(j.jsx)("input",{onChange:N,type:"email",className:"form-control",id:"email",name:"email",placeholder:"name@example.com"}),Object(j.jsx)("label",{htmlFor:"email",children:"Email address"})]}),Object(j.jsxs)("div",{className:"form-floating  mb-3",children:[Object(j.jsx)("input",{onChange:N,type:"password",className:"form-control",id:"password",name:"password",placeholder:"Password"}),Object(j.jsx)("label",{htmlFor:"password",children:"Password"})]}),!x&&Object(j.jsxs)("div",{className:"form-floating",children:[Object(j.jsx)("input",{onChange:N,type:"password",className:"form-control",id:"confirm",name:"confirm",placeholder:"Confirm password"}),Object(j.jsx)("label",{htmlFor:"password",children:"Confirm password"})]}),Object(j.jsx)("hr",{}),x&&Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:y,disabled:r,className:"btn btn-primary m-1",children:"\u0412\u043e\u0439\u0442\u0438"}),Object(j.jsx)("button",{onClick:function(){return g()},disabled:r,className:"btn btn-link m-1",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]}),!x&&Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:g,disabled:r,className:"btn btn-link",children:"\u0412\u043e\u0439\u0442\u0438"}),Object(j.jsx)("button",{onClick:function(){return w(!0)},disabled:r,className:"btn btn-primary",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})]})]})})},W=(n(53),"userData"),z=n(39),M=(l={},Object(h.a)(l,g,(function(e){return Object(m.a)(Object(m.a)({},e),{},{loading:!0})})),Object(h.a)(l,N,(function(e,t){var n=t.payload;return Object(m.a)(Object(m.a)({},e),{},{notes:[].concat(Object(z.a)(e.notes),[n])})})),Object(h.a)(l,w,(function(e,t){var n=t.payload;return Object(m.a)(Object(m.a)({},e),{},{notes:n,loading:!1})})),Object(h.a)(l,y,(function(e,t){var n=t.payload;return Object(m.a)(Object(m.a)({},e),{},{notes:e.notes.filter((function(e){return e._id!==n}))})})),Object(h.a)(l,k,(function(e,t){var n=t.payload;return Object(m.a)(Object(m.a)({},e),{},{notes:e.notes.map((function(e){return e._id===n.id&&(e.done=n.flag),e}))})})),Object(h.a)(l,"DEFAULT",(function(e){return e})),l),K=function(e,t){return(M[t.type]||M.DEFAULT)(e,t)},q=n(18),V=n.n(q),G=(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_BASE,function(e){var t=e.children,n=Object(a.useContext)(d),r=Object(a.useReducer)(K,{notes:[],loading:!1}),c=Object(f.a)(r,2),s=c[0],o=c[1],i=function(){return o({type:g})},u=function(){var e=Object(I.a)(F.a.mark((function e(t){var n,a,r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(),n={headers:{Authorization:"Bearer "+t}},e.next=4,V.a.get("/api/note/",n);case 4:a=e.sent,r=Object.keys(a.data).map((function(e){return Object(m.a)(Object(m.a)({},a.data[e]),{},{id:e})})),o({type:w,payload:r});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(I.a)(F.a.mark((function e(t,a){var r,c,s,i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={text:t},c={headers:{Authorization:"Bearer "+a}},e.prev=2,e.next=5,V.a.post("/api/note/add",r,c);case 5:s=e.sent,i=Object(m.a)(Object(m.a)({},s.data.note),{},{id:s.data.note._id}),200===s.status&&n.show("\u0417\u0430\u043c\u0435\u0442\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0430","success"),o({type:N,payload:i}),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(2),new Error(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n){return e.apply(this,arguments)}}(),b=function(){var e=Object(I.a)(F.a.mark((function e(t,a){var r,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={id:t},c={headers:{Authorization:"Bearer "+a}},e.next=4,V.a.post("/api/note/remove",r,c);case 4:200===e.sent.status&&n.show("\u0417\u0430\u043c\u0435\u0442\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0430","warning"),o({type:y,payload:t});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(I.a)(F.a.mark((function e(t,a,r){var c,s;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={id:t,done:a},s={headers:{Authorization:"Bearer "+r}},e.next=4,V.a.post("/api/note/update",c,s);case 4:200===e.sent.status&&n.show("\u0417\u0430\u043c\u0435\u0442\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430","success"),o({type:k,payload:{id:t,flag:a}});case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();return Object(j.jsx)(_.Provider,{value:{showLoader:i,addNote:l,removeNote:b,fetchNotes:u,updateNote:O,loading:s.loading,notes:s.notes},children:t})});var Q=function(){var e=function(){var e=Object(a.useState)(null),t=Object(f.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),s=Object(f.a)(c,2),o=s[0],i=s[1],u=Object(a.useCallback)((function(e,t){r(e),i(t),localStorage.setItem(W,JSON.stringify({userId:t,token:e}))}),[]),l=Object(a.useCallback)((function(){r(null),i(null),localStorage.removeItem(W)}),[]);return Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem(W));e&&e.token&&u(e.token,e.userId)}),[u]),{login:u,logout:l,token:n,userId:o}}(),t=e.token,n=e.login,r=e.logout,c=e.userId,s=!!t,i=function(e){return e?Object(j.jsxs)(T.d,{children:[Object(j.jsx)(T.b,{path:"/",exact:!0,component:U}),Object(j.jsx)(T.a,{to:"/"})]}):Object(j.jsxs)(T.d,{children:[Object(j.jsx)(T.b,{path:"/",exact:!0,component:J}),Object(j.jsx)(T.a,{to:"/"})]})}(s);return Object(j.jsx)(S,{children:Object(j.jsx)(b.Provider,{value:{token:t,userId:c,login:n,logout:r,isAuthenticated:s},children:Object(j.jsx)(G,{children:Object(j.jsxs)(o.a,{children:[Object(j.jsx)(O,{}),Object(j.jsxs)("div",{className:"container pt-4",children:[Object(j.jsx)(p,{}),i]})]})})})})},X=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,76)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};n(71).config(),s.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(Q,{})}),document.getElementById("root")),X()}},[[75,1,2]]]);
//# sourceMappingURL=main.cda5b171.chunk.js.map