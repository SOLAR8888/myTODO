(this["webpackJsonpsolar-todo-client"]=this["webpackJsonpsolar-todo-client"]||[]).push([[0],{45:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(16),s=n.n(c),o=(n(45),n(27));function i(){}var u,l,d=Object(r.createContext)({token:null,userId:null,login:i,logout:i,isAuthenticated:!1}),b=Object(r.createContext)(),j=n(1),O=function(){var e=Object(r.useContext)(b),t=Object(r.useContext)(d);return Object(j.jsxs)("nav",{className:"navbar navbar-dark navbar-expand-lg bg-dark",children:[Object(j.jsx)("div",{className:"navbar-brand",children:"TODOwe4ka"}),t.isAuthenticated&&Object(j.jsx)("button",{onClick:function(){t.logout(),e.hide()},type:"button",className:"btn btn-outline-light m-1",children:"\u0412\u044b\u0439\u0442\u0438"})]})},p=function(){var e=Object(r.useContext)(b),t=e.alert,n=e.hide;return t.visible?Object(j.jsxs)("div",{className:"alert alert-".concat(t.type||"warning"," alert-dismissible"),children:[Object(j.jsx)("strong",{children:"success"===t.type?"\u0423\u0445 \u0442\u044b! ":"\u042d\u043c\u043c... "}),t.text,Object(j.jsx)("button",{onClick:n,type:"button",className:"btn-close","aria-label":"Close"})]}):null},f=n(7),x=n(12),h=n(4),m="SHOW_ALERT",v="HIDE_ALERT",g="SHOW_LOADER",N="ADD_NOTE",k="FETCH_NOTES",w="REMOVE_NOTE",y="UPDATE_NOTE",C=(u={DEFAULT:function(e){return e}},Object(x.a)(u,m,(function(e,t){var n=t.payload;return Object(h.a)(Object(h.a)({},n),{},{visible:!0})})),Object(x.a)(u,v,(function(e){return Object(h.a)(Object(h.a)({},e),{},{visible:!1})})),u),E=function(e,t){return(C[t.type]||C.DEFAULT)(e,t)},S=function(e){var t=e.children,n=Object(r.useReducer)(E,{visible:!1}),a=Object(f.a)(n,2),c=a[0],s=a[1],o=function(){return s({type:v})};return Object(j.jsx)(b.Provider,{value:{show:function(e){},hide:o,alert:c},children:t})},_=n(6),T=n(5),A=n.n(T),D=n(9),I=Object(r.createContext)(),F=function(){var e=Object(r.useState)(""),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Object(r.useContext)(b),s=Object(r.useContext)(I).addNote,o=Object(r.useContext)(d).token;return Object(j.jsx)("form",{onSubmit:function(e){e.preventDefault(),n.trim()?(s(n,o),a("")):c.show("\u0417\u0430\u043c\u0435\u0442\u043a\u0430 \u043f\u0443\u0441\u0442\u0430\u044f")},className:"form-inline",children:Object(j.jsx)("div",{className:"form-group",children:Object(j.jsxs)("div",{className:"input-group",children:[Object(j.jsx)("input",{type:"text",className:"form-control",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u043c\u0435\u0442\u043a\u0438",value:n,onChange:function(e){a(e.target.value)}}),Object(j.jsx)("div",{className:"input-group-append",children:Object(j.jsx)("button",{type:"submit",className:"btn btn-outline-secondary",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})})})},P=n(28),L=n(15),R=n(29),B=n(20),H=function(e){var t=e.notes,n=e.filter;L.b.add(R.a,R.b);var a=Object(r.useContext)(I),c=a.removeNote,s=a.updateNote,o=Object(r.useContext)(d).token,i=Object(r.useState)(""),u=Object(f.a)(i,2),l=u[0],b=u[1],O=Object(r.useState)(!1),p=Object(f.a)(O,2),x=p[0],m=p[1],v=function(){var e=Object(D.a)(A.a.mark((function e(t,n){var r,a,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t._id,a=t.done,c=t.order,m(!0),b(r),e.next=5,s(r,!a,c,n);case 5:m(!1),b("");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=Object(D.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),b(t),e.next=4,c(t,n);case 4:m(!1),b("");case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(j.jsx)(B.c,{droppableId:"notes",children:function(e){return Object(j.jsxs)("ul",Object(h.a)(Object(h.a)({className:"list-group",ref:e.innerRef},e.droppableProps),{},{children:[t.map((function(e){return e.order||(e.order=0),e})).sort((function(e,t){return e.order-t.order})).filter((function(e){switch(n){case 0:return!0;case 1:return e.done;case 2:return!e.done}return!0})).map((function(e,t){return Object(j.jsx)(B.b,{draggableId:e._id,index:t,children:function(t){return Object(r.createElement)("li",Object(h.a)(Object(h.a)(Object(h.a)({},t.draggableProps),t.dragHandleProps),{},{ref:t.innerRef,className:"list-group-item note",key:e.id}),Object(j.jsxs)("div",{className:"note-text",children:[Object(j.jsxs)("strong",{style:e.done?{textDecoration:"line-through"}:{},children:[" ",e.text," "]}),Object(j.jsx)("div",{className:"text-info text-sm-start",children:new Date(e.createdAt).toLocaleString()})]}),Object(j.jsxs)("div",{className:"buttons",children:[Object(j.jsxs)("button",{onClick:function(){return v(e,o)},className:e.done?"btn btn-success btn-sm mx-1":"btn btn-outline-success btn-sm mx-1",children:[(!x||l!==e._id)&&Object(j.jsx)(P.a,{className:"fa-fw",icon:"check"}),x&&l===e._id&&Object(j.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})]}),Object(j.jsxs)("button",{onClick:function(){return g(e._id,o)},"data-bs-toggle":"modal","data-bs-target":"#modal",type:"button",className:"btn btn-outline-danger btn-sm mx-1",children:[(!x||l!==e._id)&&Object(j.jsx)(P.a,{className:"fa-fw",icon:"times"}),x&&l===e._id&&Object(j.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})]})]}))}},e._id)})),e.placeholder]}))}})},U=function(e){var t=e.filter,n=e.setFilter;return Object(j.jsx)("div",{className:"filter",children:Object(j.jsxs)("div",{className:"btn-group",role:"group","aria-label":"Basic example",children:[Object(j.jsx)("button",{onClick:function(){return n(0)},type:"button",className:"btn btn".concat(0===t?"":"-outline","-secondary"),children:"\u0412\u0441\u0435"}),Object(j.jsx)("button",{onClick:function(){return n(1)},type:"button",className:"btn btn".concat(1===t?"":"-outline","-secondary"),children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"}),Object(j.jsx)("button",{onClick:function(){return n(2)},type:"button",className:"btn btn".concat(2===t?"":"-outline","-secondary"),children:"\u041d\u0435\u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"})]})})},J=function(){var e=Object(r.useContext)(I),t=(e.loading,e.notes),n=e.fetchNotes,a=e.updateNote,c=Object(r.useContext)(d).token,s=Object(r.useState)(0),o=Object(f.a)(s,2),i=o[0],u=o[1];Object(r.useEffect)((function(){n(c)}),[]);var l=function(){var e=Object(D.a)(A.a.mark((function e(n){var r,s,o,i,u;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.destination){e.next=2;break}return e.abrupt("return");case 2:if(n.destination.index!=n.source.index){e.next=4;break}return e.abrupt("return");case 4:return r=t.sort((function(e,t){return e.order-t.order})),s=r[n.source.index],0==n.destination.index?o=r[0].order-1e-6:n.destination.index==r.length-1?o=r[r.length-1].order+1e-6:(i=n.destination.index-n.source.index>0?r[n.destination.index].order:r[n.destination.index-1].order,u=n.destination.index-n.source.index>0?r[n.destination.index+1].order:r[n.destination.index].order,o=(i+u)/2),s.order=o,e.next=10,a(s._id,s.done,s.order,c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)(r.Fragment,{children:[Object(j.jsx)(F,{}),Object(j.jsx)("hr",{}),Object(j.jsx)(U,{filter:i,setFilter:u}),Object(j.jsx)(B.a,{onDragEnd:l,children:Object(j.jsx)(H,{notes:t,filter:i})})]})},W=function(){var e=Object(r.useContext)(d),t=Object(r.useCallback)((function(e){window.M&&e&&window.M.toast({html:e})}),[]),n=function(){var e=Object(r.useState)(!1),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),s=Object(f.a)(c,2),o=s[0],i=s[1];return{loading:n,request:Object(r.useCallback)(function(){var e=Object(D.a)(A.a.mark((function e(t){var n,r,c,s,o,u=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:"GET",r=u.length>2&&void 0!==u[2]?u[2]:null,c=u.length>3&&void 0!==u[3]?u[3]:{},a(!0),e.prev=4,r&&(r=JSON.stringify(r),c["Content-Type"]="application/json"),e.next=8,fetch(t,{method:n,body:r,headers:c});case 8:return s=e.sent,e.next=11,s.json();case 11:if(o=e.sent,s.ok){e.next=14;break}throw new Error(o.message||"\u041e\u0448\u0438\u0431\u043e\u0447\u043a\u0430 \u0432\u044b\u0448\u043b\u0430");case 14:return a(!1),e.abrupt("return",o);case 18:throw e.prev=18,e.t0=e.catch(4),a(!1),i(e.t0.message),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:o,clearError:Object(r.useCallback)((function(){return i(null)}),[])}}(),a=n.loading,c=n.error,s=n.request,o=n.clearError,i=Object(r.useState)({email:"",password:""}),u=Object(f.a)(i,2),l=u[0],b=u[1],O=Object(r.useState)(!0),p=Object(f.a)(O,2),m=p[0],v=p[1];Object(r.useEffect)((function(){t(c),o()}),[c,t,o]);var g=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];v(!m),e||(document.getElementById("email").value="",document.getElementById("password").value="")},N=function(e){b(Object(h.a)(Object(h.a)({},l),{},Object(x.a)({},e.target.name,e.target.value)))},k=function(){var n=Object(D.a)(A.a.mark((function n(){var r;return A.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,l.password===l.confirm){n.next=4;break}return t("\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"),n.abrupt("return");case 4:return n.next=6,s("/api/auth/register","POST",Object(h.a)({},l));case 6:(r=n.sent).token&&e.login(r.token,r.userId),t(r.message),n.next=13;break;case 11:n.prev=11,n.t0=n.catch(0);case 13:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(){return n.apply(this,arguments)}}(),w=function(){var t=Object(D.a)(A.a.mark((function t(){var n;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s("/api/auth/login","POST",Object(h.a)({},l));case 3:n=t.sent,e.login(n.token,n.userId),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return Object(j.jsx)(r.Fragment,{children:Object(j.jsxs)("div",{className:"card",children:[Object(j.jsx)("h5",{className:"card-header",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"}),Object(j.jsxs)("div",{className:"card-body",children:[Object(j.jsxs)("div",{className:"form-floating mb-3",children:[Object(j.jsx)("input",{onChange:N,type:"email",className:"form-control",id:"email",name:"email",placeholder:"name@example.com"}),Object(j.jsx)("label",{htmlFor:"email",children:"Email address"})]}),Object(j.jsxs)("div",{className:"form-floating  mb-3",children:[Object(j.jsx)("input",{onChange:N,type:"password",className:"form-control",id:"password",name:"password",placeholder:"Password"}),Object(j.jsx)("label",{htmlFor:"password",children:"Password"})]}),!m&&Object(j.jsxs)("div",{className:"form-floating",children:[Object(j.jsx)("input",{onChange:N,type:"password",className:"form-control",id:"confirm",name:"confirm",placeholder:"Confirm password"}),Object(j.jsx)("label",{htmlFor:"password",children:"Confirm password"})]}),Object(j.jsx)("hr",{}),m&&Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:w,disabled:a,className:"btn btn-primary m-1",children:"\u0412\u043e\u0439\u0442\u0438"}),Object(j.jsx)("button",{onClick:function(){return g()},disabled:a,className:"btn btn-link m-1",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]}),!m&&Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:g,disabled:a,className:"btn btn-link",children:"\u0412\u043e\u0439\u0442\u0438"}),Object(j.jsx)("button",{onClick:function(){return k(!0)},disabled:a,className:"btn btn-primary",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})]})]})})},z=(n(54),"userData"),M=n(40),K=(l={},Object(x.a)(l,g,(function(e){return Object(h.a)(Object(h.a)({},e),{},{loading:!0})})),Object(x.a)(l,N,(function(e,t){var n=t.payload;return Object(h.a)(Object(h.a)({},e),{},{notes:[].concat(Object(M.a)(e.notes),[n])})})),Object(x.a)(l,k,(function(e,t){var n=t.payload;return Object(h.a)(Object(h.a)({},e),{},{notes:n,loading:!1})})),Object(x.a)(l,w,(function(e,t){var n=t.payload;return Object(h.a)(Object(h.a)({},e),{},{notes:e.notes.filter((function(e){return e._id!==n}))})})),Object(x.a)(l,y,(function(e,t){var n=t.payload;return Object(h.a)(Object(h.a)({},e),{},{notes:e.notes.map((function(e){return e._id===n.id&&(e.done=n.flag,e.order=n.order),e}))})})),Object(x.a)(l,"DEFAULT",(function(e){return e})),l),q=function(e,t){return(K[t.type]||K.DEFAULT)(e,t)},V=n(21),G=n.n(V),Q=(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_BASE,function(e){var t=e.children,n=Object(r.useContext)(b),a=Object(r.useReducer)(q,{notes:[],loading:!1}),c=Object(f.a)(a,2),s=c[0],o=c[1],i=function(){return o({type:g})},u=function(){var e=Object(D.a)(A.a.mark((function e(t){var n,r,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(),n={headers:{Authorization:"Bearer "+t}},e.next=4,G.a.get("/api/note/",n);case 4:r=e.sent,a=Object.keys(r.data).map((function(e){return Object(h.a)(Object(h.a)({},r.data[e]),{},{id:e})})),o({type:k,payload:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(D.a)(A.a.mark((function e(t,r){var a,c,s,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={text:t},c={headers:{Authorization:"Bearer "+r}},e.prev=2,e.next=5,G.a.post("/api/note/add",a,c);case 5:s=e.sent,i=Object(h.a)(Object(h.a)({},s.data.note),{},{id:s.data.note._id}),200===s.status&&n.show("\u0417\u0430\u043c\u0435\u0442\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0430","success"),o({type:N,payload:i}),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(2),new Error(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n){return e.apply(this,arguments)}}(),d=function(){var e=Object(D.a)(A.a.mark((function e(t,r){var a,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t},c={headers:{Authorization:"Bearer "+r}},e.next=4,G.a.post("/api/note/remove",a,c);case 4:200===e.sent.status&&n.show("\u0417\u0430\u043c\u0435\u0442\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0430","warning"),o({type:w,payload:t});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(D.a)(A.a.mark((function e(t,r,a,c){var s,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={id:t,done:r,order:a},i={headers:{Authorization:"Bearer "+c}},e.next=4,G.a.post("/api/note/update",s,i);case 4:200===e.sent.status&&n.show("\u0417\u0430\u043c\u0435\u0442\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430","success"),o({type:y,payload:{id:t,flag:r,order:a}});case 7:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}();return Object(j.jsx)(I.Provider,{value:{showLoader:i,addNote:l,removeNote:d,fetchNotes:u,updateNote:O,loading:s.loading,notes:s.notes},children:t})});var X=function(){var e=function(){var e=Object(r.useState)(null),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),s=Object(f.a)(c,2),o=s[0],i=s[1],u=Object(r.useCallback)((function(e,t){a(e),i(t),localStorage.setItem(z,JSON.stringify({userId:t,token:e}))}),[]),l=Object(r.useCallback)((function(){a(null),i(null),localStorage.removeItem(z)}),[]);return Object(r.useEffect)((function(){var e=JSON.parse(localStorage.getItem(z));e&&e.token&&u(e.token,e.userId)}),[u]),{login:u,logout:l,token:n,userId:o}}(),t=e.token,n=e.login,a=e.logout,c=e.userId,s=!!t,i=function(e){return e?Object(j.jsxs)(_.d,{children:[Object(j.jsx)(_.b,{path:"/",exact:!0,component:J}),Object(j.jsx)(_.a,{to:"/"})]}):Object(j.jsxs)(_.d,{children:[Object(j.jsx)(_.b,{path:"/",exact:!0,component:W}),Object(j.jsx)(_.a,{to:"/"})]})}(s);return Object(j.jsx)(S,{children:Object(j.jsx)(d.Provider,{value:{token:t,userId:c,login:n,logout:a,isAuthenticated:s},children:Object(j.jsx)(Q,{children:Object(j.jsxs)(o.a,{children:[Object(j.jsx)(O,{}),Object(j.jsxs)("div",{className:"container pt-4",children:[Object(j.jsx)(p,{}),i]})]})})})})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,77)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};n(72).config(),s.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(X,{})}),document.getElementById("root")),Y()}},[[76,1,2]]]);
//# sourceMappingURL=main.b28fafff.chunk.js.map